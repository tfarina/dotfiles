#!/bin/bash
#
# Copyright (c) 2012, Thiago Farina
#
# 2012-09-01 Thiago Farina <tfarina@chromium.org>
#

# Die if any command dies.
set -e

NUM_JOBS="$(grep -c "^processor" /proc/cpuinfo)"

cd "${HOME}/chromium/src"

# Prevent syncing in work branches.
if [[ `git rev-parse --abbrev-ref HEAD` != 'master' ]]
then
  echo 'You cannot sync outside the master branch!'
  exit 1
fi

git fetch
git pull origin master
GYP_CHROMIUM_NO_ACTION=1 gclient sync -j"${NUM_JOBS}" --nohooks
